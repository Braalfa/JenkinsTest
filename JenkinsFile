node {
    stage ('Prepare') {
        sh "sudo ssh -o StrictHostKeyChecking=no -i Llave.pem teamsoa@168.62.39.210 pm2 delete 1"
        sh "sudo ssh -o StrictHostKeyChecking=no -i Llave.pem teamsoa@168.62.39.210 pm2 delete 0"

    }
    stage ('Code_analyse') {
        sh "echo “Run some lints”"
    }
    stage ('Unit_test') {
        sh "echo “Tests will back”"
    }
    stage ('Build') {
        sh "echo “Tests will back”"
    }
    stage ('Deploy') {
        
        sh 'sudo ssh -o StrictHostKeyChecking=no -i Llave.pem teamsoa@168.62.39.210 "cd JenkinsTest && git pull"'
        sh 'sudo ssh -o StrictHostKeyChecking=no -i Llave.pem teamsoa@168.62.39.210 "cd JenkinsTest/api/myapp && export PORT=5000 && pm2 --name api start npm -- start"'
        sh 'sudo ssh -o StrictHostKeyChecking=no -i Llave.pem teamsoa@168.62.39.210 "cd JenkinsTest/frontend/myapp && export PORT=3000 && pm2 --name frontend start npm -- start"'
    }

}